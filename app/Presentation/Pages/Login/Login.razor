@page "/login"
@inject IJSRuntime JS
@inject NavigationManager Navigation
@using Core.Data.DTOs

<h3>Connexion</h3>

<EditForm Model="@loginDto" OnValidSubmit="HandleLogin">
    <DataAnnotationsValidator />
    <ValidationSummary />
    
    <div>
        <label>Nom d'utilisateur :</label>
        <InputText @bind-Value="loginDto.Username" />
    </div>
    <div>
        <label>Mot de passe :</label>
        <InputText @bind-Value="loginDto.Password" type="password" />
    </div>
    <button type="submit">Se connecter</button>
</EditForm>

<!-- Nouveau bouton pour la réinitialisation du mot de passe -->
<button @onclick="GoToRequestReset" style="margin-top:1rem;">
    Mot de passe oublié ?
</button>

@code {
    private LoginDto loginDto = new LoginDto();

    private async Task HandleLogin()
    {
        bool success = await JS.InvokeAsync<bool>("login", loginDto.Username, loginDto.Password);
        if (success)
        {
            Navigation.NavigateTo("/", true);
        }
        else
        {
            Console.WriteLine("Identifiants incorrects.");
        }
    }

    private void GoToRequestReset()
    {
        Navigation.NavigateTo("/request-reset");
    }
}